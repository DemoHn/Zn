# 第3章：语句及表达式

### 语句与语句块
**语句** (statement) 是一条完整的指令，它可以指挥电脑去执行一项具体的操作；将这些语句一条条叠加起来，即是一个完整的程序。一条完整的语句由多个词汇（关键词/标识符/文本）组合而成，且需要遵循一定的语法才能正确执行：比如 `令年龄 = 20` 即是一条正确的语句，它是由 `令`，`年龄`，`=`，`20` 这四个词拼在一起的；而 `令年龄为空` 则不然，`令`  后面不能有 `为` 关键词！

语句之间可以叠加在一起，特定语句甚至可以嵌套子语句。当数条语句叠加在一起时，我们即称这一个整体为**语句块** (statement block)。同一个语句块内的缩进值（简单来说就是每行前面的空格数）应保持一致，举个例子：

```zn
如果地区为“华南”：
    年龄 = 20
    姓名 = “小明”
    身高 = 175
否则：
    年龄 = 15
    姓名 = “小方”
    身高 = 160
```

在上面的程序中，第1-8行是一条完整的 `如果` 语句，它嵌套了两个单独的语句块：第2-4行，以及第6-8行。

##### 语句之间的分隔
语句与语句之间需要用特定的字符分隔开，否则编译器无法正确识别语句内容。比如 `令年龄 = 20` 是一条完整的语句， `令姓名 = “小明”` 也是一条完整的语句；但是将两个语句直接连起来，变成`令年龄 = 20令姓名 = “小明”` 即是不正确的，会抛出语法错误。

通常情况下，我们会通过换行的方式（按下 Enter 键）来写一条新的语句；从程序的角度，这实际上是在一行的末尾添加了一个「换行符」¹ ，每一条语句之间都使用「换行符」分隔开，比如下面两条语句即是通过换行的方式分隔；

```zn
令年龄 = 20
令姓名 = “小明”
```

还有一种情况，如果需要将多条语句放在同一行，我们即可以使用 _分号_ `；` 来分隔语句。同一行可以使用多个 _分号_ `；`  如下所示：

```zn
令年龄 = 20；令姓名 = “小明”；令身高 = 160
```

##### 词素之间的分隔
一条语句是由关键词/标识符/标点/运算符等各个词素 (token) 组成的，如 `令年龄 = 20` 即是由 *关键词* `令` + *标识符* `年龄`  + *运算符* `=` + *标识符* `20` 组合而成。

和其他语言不同， zinc 语言采用 _无空格设计_，也就是说各个词素之间（尤其关键词及标识符）不用加空格也能够正常解析。这就意味着，词素之间可以不用加任何字符加以区分！

不过，我们在编写语句的过程中可以在词素之间适当地加上 *空格* ` ` 或者*逗号* `，` 以方便阅读；*空格* 或 *逗号* 仅仅起到标记分隔的作用，并不会成为语句的一部分（就像真·逗号在文章中用于句子的停顿）。我们不妨参考以下几条案例：

**案例甲**： `如果年龄小于30且身高大于160且专业相关为真：` 是一条合法的 `如果` 语句，但直接读起来实在让人一头雾水；于是我们可以在语句之间适当加上逗号，这样阅读起来就更有条理：`如果 年龄小于30，且身高大于160，且专业相关为真：`
**案例乙**： `【10 20 30 40 50】` 用于表示一个列表以及其内含的五个数值。每项之间需要加上空格或者逗号以分隔，故而 `【10，20，30，40，50】`也是可行的。
**案例丙**：在赋值语句中，等号两边加上空格会更有助于阅读，如`年龄差 = 20` 会比 `年龄差=20` 效果更好。

##### 可用语句列表
以下是 zinc 语言所支持的所有语句列表，以供读者参考。这些语句的具体用法会在后面的章节中详细解释。

| 语句类型 | 常用语法                                   | 示例                                                           |
|------|----------------------------------------|--------------------------------------------------------------|
| 令字语句 | `令 ‹变量名› = ‹初始值›`                      | `令价格 = 20.5`                                                 |
| 每当语句 | `每当‹表达式›：<br>    ‹语句块›`                | `每当I > 0：<br>    I = I - 1`                                  |
| 遍历语句 | `以‹变量名›遍历‹表达式›：<br>    ‹语句块›`          | `以参数遍历【1，2，3，4，5】：<br>    （显示：参数）`                           |
| 如果语句 | `如果‹表达式›：<br>    ‹语句块›`                | `如果I > 0：<br>    输出“正数”`                                     |
| 如何语句 | `如何‹方法名›？<br>    ‹语句块›`                | `如何求和？<br>    输入左、右<br>    令结果 = 左 + 右<br>    输出结果`          |
| 输入语句 | `输入‹变量名›、‹变量名›…`                       | `输入品名、SKU、单价`                                                |
| 输出语句 | `输出‹表达式›`                              | `输出“正确文本”`                                                   |
| 导入语句 | `导入“‹模块名›”`                            | 导入“模块甲”                                                      |
| 抛出语句 | `抛出‹异常类型›：‹表达式›！`                      | `抛出调用异常：“异常信息”！`                                             |
| 拦截语句 | `拦截‹异常类型›：<br>    ‹语句块›`               | `拦截调用异常：<br>    （显示：“接收异常：”、其内容）`                            |
| 定义语句 | `定义‹类型名›：<br>    ‹属性列表›<br>    ‹方法列表›` | `定义货件：<br>    其尺寸 = 【20，30，40】<br>    如何计算围长？<br>        输出2 * {其尺寸#1 + 其尺寸#2}`     |

### 表达式
**表达式** (expression) 是由数值/变量/方法等元素与运算符组合而成的式子，并且这个式子经过特定运算后会得到最终的元素值。

表达式可分为两种类型：**基础表达式** (primitive expression) 以及**复合表达式** (compound expression)；基础表达式是表达式的基本单元，包括变量名、数值等单独元素，如 *数值* `250` 或者*文本* `“黄河之水天上来”`；而复合表达式即是在基础表达式的基础上，通过运算符等方式组合而成。如 `25的平方 + 4 * 3` 即是一个复合表达式，其对应结果为 `637`。

##### 基础表达式的类型

1. **变量名称：** 当一个标识符被当作变量名使用时，这个标识符本身即是一个表达式，其结果为此变量对应的元素值。如语句 `令价格 = 20；令客单价 = 价格` 中，第二条语句等号右边的 `价格` 即是一个单独的变量名，此即一个表达式，结果为 `20`。
   
2. **元素值：** 数值/文本/列表/字典元素值可以直接在程序中表示，如在语句 `令价格 = 20.46` 中，等号右边的 `20.46` 即是一个数值；这个元素值本身即是一个表达式。其他类型的元素值如下所示：
	```zinc
    令价格 = 20.46   // 等号右边即是数值
    令诗句 = “黄河之水天上来”  // 等号右边即是文本
    令等差数列 =【1，3，5，7，9】 // 等号右边即是列表
    令五笔简码字典 =【   // 等号右边即是字典类型
        H = “上”，
        J = “是”，
        K = “中”，
        L = “国”，
        M = “同”
    】   
    ```

3. **方法调用：** 方法调用即是通过传入指定的参数和方法名称，执行预先写好的语句，并输出相应的结果值。方法调用的常见格式为 `‹方法表达式› → （  ‹方法名›  ）` 或 `‹方法表达式› → （  ‹方法名› ：‹表达式1› 、 ‹表达式2›... ）`，试举数例：
   ```zinc
   令结果 =（求积：4、9）
   令随机数 =（取随机数）
   令数学成绩 = 以考生（获取单项成绩：“数学”）
   ```

##### 复合表达式的组合方式

1. **算术运算符**

算术运算符包括我们平时熟知的加、减、乘、除；算术运算符位于两个表达式之间，在执行时对左右两边的元素进行计算，得到最终结果。其对应的语法为：`‹算术表达式› → ‹表达式1› ‹运算符› ‹表达式2›`。

> 算术运算符左右两边的元素都应是**数值**！

各个运算所使用的运算符如下表所示：

| 运算方法 | 表达式  | 示例           |
| ---- | ---- | ------------ |
| 加法   | `+`  | `成本 + 5`     |
| 减法   | `-`  | `利润 - 3.7`   |
| 乘法   | `*`  | `销售额 * 0.25` |
| 除法   | `/`  | `回款 / 5`     |
| 取余   | `%`  | `39 % 5`     |
| 整除   | `\|` | `2.3 \| 1`   |

> ⚠️ 尽管 zinc 秉承着「非必要不加空格」原则，但是在输入运算表达式时，运算符前后**必须要加上空格**；这是因为 `+ - * /` 本身是可以作为标识符的一部分的，如果不加空格，诸如 `价格/2` 本身是会当作标识符本身而出现不符合预期的结果的！

2. **逻辑运算符：`且` 和 `或`**

`且` 和 `或`  都是 zinc 语言的关键词；使用方式和算术运算符类似，在执行时对左右两边的元素进行计算，得到最终结果。其对应的语法为：`‹逻辑表达式› → ‹表达式1› ‹运算符› ‹表达式2›`。

> 算术运算符左右两边的表达式都应是**逻辑**类型的值，也就是最终结果是 `真` 或 `假` ！

`且` 关键用于同时比较两个条件是否都为`真`，如果两个条件都为`真`，则整个条件表达式的结果也为`真`。举个例子，如果我们要判断一个人是否符合做网约车司机，我们即可以使用「且」运算符连接两个条件：

```zn
年龄 > 18 且 会开车
```

其中「年龄 > 18」表示这个人的年龄大于18岁，变量「会开车」表示这个人是否会开车，如果「年龄 > 18」的值为`真`，而「会开车」的值也为`真`，则整个条件表达式的结果为`真`。

「且」的真值表如下所示：

| 表达式1 | 表达式2 | 结果  |
| ---- | ---- | --- |
| `真`  | `真`  | `真` |
| `真`  | `假`  | `假` |
| `假`  | `真`  | `假` |
| `假`  | `假`  | `假` |

除了 `且` 运算符外，`或` 用于比较两个条件中是否至少有一个为`真`；如果**至少有一个**条件为`真`，则整个条件表达式的结果也为`真`。举个例子，假设某学校的录取条件是英语成绩达标（雅思、托福均可），我们即可使用「或」运算符连接两个条件：

```zn
雅思 >= 6.5或托福 > 105
```

只要「雅思 > 6.5」表达式为`真`，或者「托福 > 105」表达式为`真`，整个条件表达式的结果为`真`。

「或」运算符的真值表如下所示：

| 表达式1 | 表达式2 | 结果  |
| ---- | ---- | --- |
| `真`  | `真`  | `真` |
| `真`  | `假`  | `真` |
| `假`  | `真`  | `真` |
| `假`  | `假`  | `假` |

> 和其他关键字一样，`且` 和 `或` 关键字前后都不用加空格区分。

3. **比较运算符**

比较运算符用于比较两个元素之间的关系，并得到一个 `真` 或 `假` 的**逻辑**值作为判断结果。

目前，zinc 语言支持共 8 种比较运算符，具体信息及使用方式如下表所示：

| 运算符           | 示例                     |
| ------------- | ---------------------- |
| `==`  / `等于`  | `5 == 10`  或 `5 等于 10` |
| `/=`  / `不等于` | 检查A是否不等于B              |
| `>`  / `大于`   | 检查A是否大于B               |
| `<`  / `小于`   | 检查A是否小于B               |
| `>=`  / `不小于` | 检查A是否大于或者等于B           |
| `<=`  / `不大于` | 检查A是否小于或者等于B           |
| `为`           | `诗句为“黄河之水天上来”`         |
| `不为`          | `诗句不为“黄河之水天上来”`        |

> `为` 和 `不为` 关键词适用于所有类型，而其他比较运算符左右两边只能是数值类型；括号内的中文是对应运算符的关键字，两者完全等价。也就是说，`A == B` 和 `A等于B` 是一个意思。


4. **获取元素的属性**

在 zinc 语言中，所有的元素都有其对应的属性。我们可以通过 `之` 或 `的` 关键词以获取元素的某个属性，其语法为：`‹属性表达式› → ‹表达式›  [之 | 的]  ID`。例如： `考生的姓名`，`【10，20，30】之长度`。

`之` 或 `的` 从语法上没有任何区别，在实际使用时可以凭借表达式以及属性的名称的通顺程度来决定使用哪个关键字。

同时，在对象内定义方法时，我们可以直接用 `其` 关键字来指代欲获取属性的父元素，其语法为：`‹属性表达式› → 其  ID`。


5. **获取列表/字典的成员**

对于列表/字典类型的变量而言，我们能够通过对应的索引获取到这个变量对应的某个值；
- 如果是列表类型，可以获取其第 N 个元素值
- 如果是字典类型，可以获取某个索引名称对应的元素值

其语法大致如下所示：

```
‹成员表达式›   ::=  ‹表达式›  #  数值
               |  ‹表达式›  #  文本
               |  ‹表达式›  #  {  ‹表达式›  }
```

试举数例：

```zn
【2，4，6，8，10】#2     注1：获取列表的第2个元素，结果为4
【T=“和”，R=“的”，E=“有”】#E   注2：获取字典中“E”对应的值，结果为“有”
【2，4，6，8，10】#{5 - 3}     注3：获取列表的第2个元素，结果为4
```

##### 运算符的优先级

我们可以使用多个运算符来表示一个复合表达式。需要注意的是，计算这个复合表达式时，并不是单纯的从左往右处理运算符，而是根据一定的优先级依次处理。

运算符的优先级决定了表达式中运算执行的先后顺序。当一个表达式中包含了多个运算符时，我们先按照优先级高低依次执行，高优先级的表达式的执行结果即作为低优先级表达式的操作数；相同优先级的表达式即按照**从左往右**的顺序依次执行。

举个例子：在表达式 `20 - 5 + 10 * 7` 中，根据「先乘除，后加减」原则，我们先处理后面的 `*` （因为它的优先级更高），再处理前面的 `-` 和 `+` 运算符！于是，整个表达式的实际处理流程如下：
1)  20 - 5 + **10 * 7**  → 20 - 5 + **70**
2)  **20 - 5** + 70 → **15** + 70
3) **15 + 70** → **85** （最终结果为 `85`）

在某些情况下，如果我们需要将某部分表达式强制以最高优先级处理，我们可以在其外围加上**一对花括号** `{ }` 以提升其优先级，如表达式 `20 - {5 + 10} * 7` 中，其实际处理流程如下：

1) 20 - **{5 + 10}** * 7 → 20 - **15** * 7
2) 20 - **15 * 7** → 20 - **105**
3) **20 - 105** →  **-85**（最终结果为 `-85`）

运算符的优先级列表如下所示，数字越大表示优先级越高：

<table>
  <thead>
    <tr>      
      <th align="center">优先级</th>
      <th>运算符类型</th>
      <th>运算符</th>      
      <th>备注</th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td align="center">七级</td>
      <td>花括号组合</td>
      <td><code>{ }</code></td>
      <td></td>
    </tr>
    <tr>
      <td align="center" rowspan="2">六级</td>
      <td>访问列表/字典的成员</td>
      <td><code>#</code></td>
      <td><code>【10，20】#1 + 1</code> 得到 11 而不是 20</td>
    </tr>
    <tr>
      <td>获取元素的属性</td>
      <td><code>之，的</code></td>
      <td><code>【10，20】之长度 + 1</code> 得到 3</td>
    </tr>
    <tr>
      <td align="center" rowspan="4">五级</td>
      <td>乘法</td>
      <td><code>*</code></td>
      <td></td>
    </tr>
    <tr>      
      <td>除法</td>
      <td><code>/</code></td>
      <td>乘、除是并列的</td>
    </tr>
    <tr>      
      <td>整除</td>
      <td><code>|</code></td>
      <td></td>
    </tr>
    <tr>      
      <td>取余</td>
      <td><code>%</code></td>
      <td></td>
    </tr>
    <tr>
      <td align="center" rowspan="2">四级</td>
      <td>加法</td>
      <td><code>+</code></td>
      <td></td>
    </tr>
    <tr>      
      <td>减法</td>
      <td><code>-</code></td>
      <td>加减是并列的</td>
    </tr>
    <tr>
      <td align="center" rowspan="6">三级</td>
      <td>相等（数值比较）</td>
      <td><code>等于</code>，<code>==</code></td>
      <td></td>
    </tr>
    <tr>      
      <td>不相等（数值比较）</td>
      <td><code>不等于</code>，<code>/=</code></td>
      <td></td>
    </tr>
    <tr>      
      <td>大于（数值比较）</td>
      <td><code>大于</code>，<code>&gt;</code></td>
      <td></td>
    </tr>
    <tr>      
      <td>小于（数值比较）</td>
      <td><code>小于</code>，<code>&lt;</code></td>
      <td></td>
    </tr>
    <tr>      
      <td>大于等于（数值比较）</td>
      <td><code>不小于</code>，<code>&gt;=</code></td>
      <td></td>
    </tr>
    <tr>      
      <td>小于等于（数值比较）</td>
      <td><code>不大于</code>，<code>&lt;=</code></td>
      <td></td>
    </tr>
    <tr>
      <td align="center">二级</td>
      <td>逻辑与</td>
      <td><code>且</code></td>
      <td></td>
    </tr>
    <tr>
      <td align="center">一级</td>
      <td>逻辑或</td>
      <td><code>或</code></td>
      <td></td>
    </tr>
  </tbody>
</table>