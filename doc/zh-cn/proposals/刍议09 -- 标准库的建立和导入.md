| 档案编号| 作者| 提案时间 | 状态 |
|:----:|:----:|:----:|:----:|
|〔刍议09〕| DemoHn | 2021-05-03 | 开发中 |

## 简介

为增强一门语言的实用性，一般一个语言会附送一个自带的标准库。Zn 亦不能免俗，因此本草案旨在设计标准库的建设方案以及如何在代码中导入对应的标准库的技术实现。

所谓 `标准库`，即是非第三方实现的软件库，一般会提供文件操作、网络调用、数据解析等功能。一般在代码中可以直接以 `导入《标准库》之A，B，C` 的方式引用，无需将库文件放到同一个文件夹下。

### 标准库的导入

比如有一个名为《文件》的标准库，它大概的内容是这样的：

```zn
令：
    OS 为“Windows”
    分隔符 为“/”
    权限 恒为“644”
    
如何打开文件？
    已知文件
    返回fd

如何关闭文件？
    返回0

定义文件夹：
    ...
```

在这个标准库中，可以导入的标识符有 `OS`，`分隔符`， `权限`，`打开文件`，`关闭文件`，`文件夹`。只要在代码里引用此标准库，便可以直接调用相应的变量/方法/类型。

假设有一个名为 `解析数据.zn` 的文件需要引用《文件》标准库，以下三种导入语句都可以使用，只不过会产生不同的结果，现一一介绍之：

1. `导入《 ... 》` 

> 其中，`导入` 是关键字，标准库的名称要用左右两个书名号括起来。如 `导入《文件》`

此语句将会把对应标准库里的 **所有** 标识符直接导入进对应的代码的符号表(SymbolTable)，如下述例子所示：

```zn
导入《文件》

如何解析数据？
    令F 为（打开文件：“example.zn”）
    （关闭文件：F）
    ...
```

在上面的例子中，我们可以注意到 `打开文件`，`关闭文件` 都是直接从《文件》标准库引用进来的。导入之后相当于在代码的全局作用域多了对应的标识符。

2. `导入《 ... 》 之A，B，C`

此语句将会把标准库中对应的A，B，C标识符导入进对应的代码中。如下述例子所示：

```zn
导入《文件》之分隔符，打开文件

如何解析数据？
    令F 为（打开文件：“example.zn”）    
    ...
```

在上面的例子中，当导入《文件》标准库时，只有 `分隔符`，`打开文件` 这两个标识符可以使用，使用其他标识符，如 `关闭文件` 将会报错。

3. `以 X 导入《 ... 》[之A，B，C]`

> TODO: 这点存疑，可能会删除相关内容

<del>
此语句将会在导入标准库的内容时会把X作为前缀加入到标识符中。如下述例子所示：

```zn
以O 导入《文件》

如何解析数据？
    令F 为（O-打开文件：“example.zn”）
    令G 为O-分隔符
```

在上面的例子中，我们自动给导入的标识符加上了 `O-` 前缀，所以前述的 `打开文件` 变成了 `O-打开文件`，`分隔符` 变成了 `O-分隔符`

</del>

### 标准库的建立

标准库将放置在 lib 文件夹下，以 `库名.zn` 命名，如《算法》标准库对应的源文件为 `算法.zn`。目前为简单起见，一个源文件对应一个标准库，标准库里亦不允许使用 `导入` 语句。

和 Python 等不同，标准库源文件在编译阶段就直接打包进最后的可执行文件中。这样设计主要是在最大程度上复用Go的标准库以快速实现原型。

第一批规划中的标准库如下所示：

  1. 《文件》：主要提供了文件读取、写入、列举文件夹等操作，参考API：
      - 打开文件
      - 关闭文件
      - 获取文件列表      
  2. 《日期》：主要提供日期运算、时间戳转换等功能
  3. 《算法》：提供常用算法的实现，如快速排序，二分查找等
  4. 《正则》：提供正则表达式的能力（正则表达式语法与Go正在使用的一致）
  5. 《JSON》：提供 列表 <--> JSON字符串互转的能力 （RFC7159）
  6. 《网络》：提供建立HTTP服务器、发送HTTP请求的能力