# 文本结构

本章主要介绍 Zn 语言的文本结构。Zn 程序在执行时，先经过 _分词器 (lexer)_ 将程序切割成 _语素 (token)_，而后再根据这些语素去完成后面的步骤。所以接下来的内容将主要介绍Zn 语言的文本特性及各个类型的语素，包括 _标识符 (identifier)_，_关键词 (keyword)_，_文本 (string)_，_数值 (number)_，_语句块 (block)_ 等。


## 文件及编码

Zn 程序一般以文件的形式存储。因为 Zn 程序采用 Unicode 编码解析，故文件须以 `UTF-8` 编码储存。采用其他编码（包括但不限于 `GB2312`, `Big5`, `GBK`等）存储的文件将会被认为是乱码，进而导致程序无法执行。

> ⚠️ 由于历史原因，Windows 系统在简体中文环境下的默认编码是 GBK，这导致了保存的文件一不小心就变成了GBK编码，从而导致程序解析失败。事实上，人们对“中文编程容易导致乱码”的刻板印象大多来自于此。
> 
> 解决问题的办法很简单：请使用专门的代码编辑器或者IDE去编辑程序文件！（现代的编辑器默认采用 UTF-8 编码）

文件名可以使用中文，对后缀名称并没有限制。不过为阅读方便，建议所有的Zn程序使用  `.zn` 作为后缀名。（如 `对象定义.zn`）


## 换行及缩进

Zn 程序是由一行行代码组成的。换行使得程序更加容易阅读，而且在很多情况下，完成一个语句必须需要换行。

Zn 支持以下四种 _换行符 (line break)_：`CRLF (U+000D U+000A)`，`LF (U+000A)`，`CR (U+000D)`，`LFCR (U+000A U+000D)`。一般在 Windows 下编写的文件采用 `CRLF`；而在 Linux 及 Mac 下编写的文件采用 `LF`。同一个文件下的换行符可以混用（虽然从实际角度不建议这么做），在空白行后面加换行符也是被允许的。

和 Python 类似，Zn 依赖 _缩进 (indent)_ 来标识不同层级的语句块。“缩进”一词最早来自于印刷行业，指的是在某行或某个段落前留上空白距离。而在 Zn 语言中，缩进将使用空白符来填充，并使用固定数量的空白符来表示一个单位缩进：一个单位缩进为 `4个空格 (U+0020)` 或者 `1个Tab (U+0009)` 字符。空格和Tab在同一个文件里不能混用，亦即若前一行以空格作为缩进符，则后一行不能以TAB作为缩进符。

> ✉️ 缩进值可以叠加，例如你可以在一行前面加上 12个空格 作为 缩进值为3；或者说是4个Tab 表示 缩进值为4。硬性规定4个空格做为单位缩进主要是以美观起见：毕竟在中文里空两格要比空一格好看不少。

如以下代码段所示：

```
如果程序为空：                    <--  第一行缩进值为0
    （显示：结果）                <--  前面有四个空格，缩进值为1
    每当结果大于0：
        （计算：“2+3”）          <--  前面有八个空格，缩进值为2
```

之后的章节会具体解释缩进的用途，此处先按下不表。

## 关键词及标识符

所谓“关键词” (keyword)，即是指在程序中表达特定含义的词语。Zn语言的关键词由1~3个中文字符组成，目前一共有28个关键词，分别如下所示：

```
令      为      以     其      或      且      之
定义    如何    何为    恒为    是为     成为    不为
已知    返回    如果    再如    否则     每当    此之
遍历    等于    大于    小于    不等于   不大于   不小于
```

所谓“标识符” (identifier)，即是指标识某个事物名称的词语。它可以代表变量名，也可以代表属性名、方法名等。一个合法的标识符需要满足以下几个条件：

1. **标识符的长度至少为1个Unicode字符，长度上限为32个字符。**

    > ✉️ 32个字符的限制也是为保证代码可读性而设，如果你发现连32个字符都不够用的话，是时候考虑换个名称了。

2. **标识符的第一个字符须满足以下Unicode编码范围之一：**
    - [U+4E00, U+9FEF] (中日韩统一表意文字 CJK Unified Ideographs)
    - U+3007 (中文大写数字‘〇’)
    - [U+0041, U+005A] (大写英文字母 A-Z)
    - [U+0061, U+007A] (小写英文字母 a-z)
    - U+005F (下划线符号 _)

3. **标识符其后的所有字符须满足以下Unicode编码范围之一：**

    - 如 第2点 所述之范围（亦即满足第一个字符后，其后所有字符都满足）
    - [U+0030, U+0039] (数字 0-9)
    - U+002A (符号 *)
    - U+002B (符号 +)
    - U+002D (符号 -)
    - U+002F (符号 /)
    - U+005F (符号 _)





### 附录：关键字符之Unicode码表

| 关键字符 | Unicode编码 |  备注 |
| :-----: | :--------: |  ---- |
| 不      |  	U+4E0D |       |
| 且      |  	U+4E14 |       |
| 为      |  	U+4E3A |       |
| 义      |  	U+4E49 |       |
| 之      |  	U+4E4B |       |
| 于      |  	U+4E8E |       |
| 令      |  	U+4EE4 |       |
| 以      |  	U+4EE5 |       |
| 何      |  	U+4F55 |       |
| 其      |  	U+5176 |       |
| 再      |  	U+518D |       |
| 则      |  	U+5219 |       |
| 历      |  	U+5386 |       |
| 否      |  	U+5426 |       |
| 回      |  	U+56DE |       |
| 大      |  	U+5927 |       |
| 如      |  	U+5982 |       |
| 定      |  	U+5B9A |       |
| 小      |  	U+5C0F |       |
| 已      |  	U+5DF2 |       |
| 当      |  	U+5F53 |       |
| 恒      |  	U+6052 |       |
| 成      |  	U+6210 |       |
| 或      |  	U+6216 |       |
| 是      |  	U+662F |       |
| 果      |  	U+679C |       |
| 此      |  	U+6B64 |       |
| 每      |  	U+6BCF |       |
| 注      |  	U+6CE8 |       |
| 知      |  	U+77E5 |       |
| 等      |  	U+7B49 |       |
| 返      |  	U+8FD4 |       |
| 遍      |  	U+904D |       |
